From: Kyle J. McKay <mackyle@gmail.com>
Subject: [PATCH] pcreposix.c: emulate REG_STARTEND correctly

When using the BSD REG_STARTEND emulation option, the location
of the string to match against is passed in as a starting and
ending offset relative to a subject string.

However, the returned matches, if any, still have offsets that
are relative to the same original suject string, NOT the starting
offset that was passed in.

In other words, if the pattern is "d$" and the REG_STARTEND option
is used to match against "abcde" using a starting offset of 2 and
an ending offset of 4 it should match and the match result should
have a starting offset of 3 and an ending offset of 4 NOT a starting
offset of 1 and an ending offset of 2.

This was corrected in pcre-8.41 after a bug report was filed about
it, but the fix failed to consider the possibility that either
rm_so or rm_eo could be less than zero.  If that ever happens
(as an error indication that the group in question did not match),
then the error indication would be corrupted by adding a non-zero
starting offset.

Fix this so that it works properly by adding the starting offset
back only to any successful matches (i.e. rm_so and rm_eo are both
greather than or equal to zero) as they're returned, but be sure
to leave unsuccessful match results alone.

Note: This patch is licensed under the same terms as PCRE itself.

Signed-off-by: Kyle J. McKay <mackyle@gmail.com>
