From: Kyle J. McKay <mackyle@gmail.com>
Subject: [PATCH] improve pcreposix REG_NEWLINE POSIX emulation

The pcreposix wrapper emulates the POSIX regex library fairly well
except in one respect, REG_NEWLINE.

Unfortunately, this greatly limits its ability to be used as a
drop-in replacement.

To improve POSIX REG_NEWLINE compatibility, the following changes
are effected:

1. The existing REG_NEWLINE is renamed to REG_MULTILINE.

   In other words, REG_MULTILINE becomes a pass-through to the
   PCRE_MULTILINE option.

2. A new PCRE_NOT_EXCLUDES_NL option is provided.

   This is implemented in the standard PCRE library and is
   available for any caller to use.  If a character class
   begins with "^" AND this option is set then it will NOT
   match "\n" (or whatever "\n" might happen to be matching).

3. A new "macro" REG_NEWLINE option is implemented with
   the following behavior:

   REG_NEWLINE unset:
     PCRE_DOTALL is set
     PCRE_DOLLAR_ENDONLY is set

   REG_NEWLINE set:
     PCRE_NOT_EXCLUDES_NL is set
     PCRE_MULTILINE is set

   Note that REG_NEWLINE never unsets any PCRE options so if
   it is combined with use of REG_DOTALL and/or REG_MULTILINE
   the results may not match POSIX semantics, but since neither
   REG_DOTALL nor REG_MULTILINE are POSIX in the first place
   using them already violates POSIX semantics to begin with.

   While these changes do affect the behavior of the pcreposix
   wrapper, no defines have been removed and only two have been
   added (one to pcre and one to pcreposix).  All existing code
   using the pcreposix wrapper will still compile but it may
   behave unexpectedly if it's relying on the non-POSIX semantics
   of the previous version of the pcrePOSIX wrapper.

Note: This patch is licensed under the same terms as PCRE itself.

Signed-off-by: Kyle J. McKay <mackyle@gmail.com>
